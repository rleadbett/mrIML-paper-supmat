[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MrIML 2.0 Case Studies",
    "section": "",
    "text": "1 Overview\nThis document contains detailed descriptions of the suplementary code for (Fountain-Jones et al. 2024). Three case studies are presented along with a simulation study.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "index.html#case-studies",
    "href": "index.html#case-studies",
    "title": "MrIML 2.0 Case Studies",
    "section": "1.1 Case Studies",
    "text": "1.1 Case Studies\nThis repository demonstrates MrIML 2.0 across four ecological systems. Each case study is self-contained with data, code, and interpretation.\n\n1.1.1 Case Study 1: Avian Blood Parasites\nAnalysis of co-occurrence patterns in vector-borne parasites from New Caledonian birds. Demonstrates asymmetric associations and the relative importance of host abundance versus biotic interactions.\nKey findings: Host abundance is the primary driver, but parasite co-occurrence significantly improves predictions. Asymmetric associations reveal directional effects between parasite species.\n\n\n1.1.2 Case Study 2: Forest Communities\nMulti-taxonomic analysis of beetles, birds, and plants across forest successional gradients. Compares assembly mechanisms among different taxonomic groups.\nKey findings: Environmental filtering dominates across all groups. Plant communities show strongest responses to successional gradients, while bird and beetle communities respond primarily to altitude and microclimate.\n\n\n1.1.3 Case Study 3: Ostrich Gut Microbiome\nMicrobiome development across three gut sections (ileum, caecum, colon) in juvenile ostriches. Examines age-dependent assembly and section-specific patterns.\nKey findings: Critical developmental window at 20-40 days post-hatching. Positive associations dominate across all gut sections, with age and weight as primary predictors.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "index.html#simulation-study",
    "href": "index.html#simulation-study",
    "title": "MrIML 2.0 Case Studies",
    "section": "1.2 Simulation study",
    "text": "1.2 Simulation study\nA simulation study.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "index.html#computing-enviroment-information",
    "href": "index.html#computing-enviroment-information",
    "title": "MrIML 2.0 Case Studies",
    "section": "1.3 Computing enviroment information",
    "text": "1.3 Computing enviroment information\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sequoia 15.6\n\nMatrix products: default\nBLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Hobart\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n [1] patchwork_1.3.2    cowplot_1.2.0      ggnetwork_0.5.14   igraph_2.2.1      \n [5] flashlight_1.0.0   finetune_1.2.1     future_1.67.0      yardstick_1.3.2   \n [9] workflowsets_1.1.1 workflows_1.3.0    tune_2.0.1         tailor_0.1.0      \n[13] rsample_1.3.1      recipes_1.3.1      parsnip_1.3.3      modeldata_1.5.1   \n[17] infer_1.0.9        dials_1.4.2        scales_1.4.0       broom_1.0.10      \n[21] tidymodels_1.4.1   mrIML_2.1.0        here_1.0.2         readxl_1.4.5      \n[25] DT_0.34.0          lubridate_1.9.4    forcats_1.0.1      stringr_1.6.0     \n[29] dplyr_1.1.4        purrr_1.2.0        readr_2.1.5        tidyr_1.3.1       \n[33] tibble_3.3.0       ggplot2_4.0.0      tidyverse_2.0.0   \n\nloaded via a namespace (and not attached):\n [1] rlang_1.1.6           magrittr_2.0.4        furrr_0.3.1          \n [4] compiler_4.5.2        vctrs_0.6.5           lhs_1.2.0            \n [7] pkgconfig_2.0.3       fastmap_1.2.0         backports_1.5.0      \n[10] rmarkdown_2.30        prodlim_2025.04.28    tzdb_0.5.0           \n[13] network_1.19.0        xfun_0.54             jsonlite_2.0.0       \n[16] parallel_4.5.2        R6_2.6.1              stringi_1.8.7        \n[19] RColorBrewer_1.1-3    parallelly_1.45.1     rpart_4.1.24         \n[22] cellranger_1.1.0      Rcpp_1.1.0            knitr_1.50           \n[25] future.apply_1.20.0   Matrix_1.7-4          splines_4.5.2        \n[28] nnet_7.3-20           timechange_0.3.0      tidyselect_1.2.1     \n[31] rstudioapi_0.17.1     yaml_2.3.10           timeDate_4051.111    \n[34] codetools_0.2-20      listenv_0.10.0        lattice_0.22-7       \n[37] withr_3.0.2           S7_0.2.0              coda_0.19-4.1        \n[40] evaluate_1.0.5        survival_3.8-3        pillar_1.11.1        \n[43] renv_1.1.5            generics_0.1.4        rprojroot_2.1.1      \n[46] hms_1.1.4             globals_0.18.0        class_7.3-23         \n[49] glue_1.8.0            tools_4.5.2           data.table_1.17.8    \n[52] gower_1.0.2           grid_4.5.2            ipred_0.9-15         \n[55] cli_3.6.5             DiceDesign_1.10       lava_1.8.2           \n[58] gtable_0.3.6          GPfit_1.0-9           digest_0.6.37        \n[61] sna_2.8               htmlwidgets_1.6.4     farver_2.1.2         \n[64] htmltools_0.5.8.1     lifecycle_1.0.4       hardhat_1.4.2        \n[67] statnet.common_4.12.0 MASS_7.3-65          \n\n\n\n\n\n\nFountain-Jones, Nicholas M, Raima Carol Appaw, Moh A Alkhamis, Susan C Baker, Francisca Powell-Romero, Nicholas J Clark, Michael Mayer, Gustavo Machado, and Elin Videvall. 2024. “Advancing Ecological Community Analysis with MrIML 2.0: Unravelling Taxa Associations Through Interpretable Machine Learning.” https://doi.org/DOI: 10.22541/au.172676147.77148600/v1.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Overview</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html",
    "href": "case-studies/01-avian-parasites/dummy.html",
    "title": "2  Avian blood parasites",
    "section": "",
    "text": "2.1 Model definition\nThis case study demonstrates the application of MrIML 2.0 to a small dataset of vector-borne blood parasites in New Caledonian birds. We analyze presence/absence data from four parasite species:\nThe dataset includes 449 individual birds and a covariate representing the proportion of captures attributed to Zosterops spp. at each site, serving as a proxy for host relative abundance.\nTo prepare the data for multi-response modeling, we separate it into Y (response), X (predictors), and X1(co-occurrence predictors). This is how data is parsed to mrIML.\nWe formulate three models of community assembly to compare the relative importance of co-occurrence versus environmental effects:\nHowever, all three of these model configerations utilise the same base random forest model specified using tidymodels.\n# Define random forest model\nmodel_rf &lt;- rand_forest(\n  trees = 1000,\n  mode = \"classification\",\n  mtry = tune(),\n  min_n = tune()\n) %&gt;%\n  set_engine(\"randomForest\")",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#model-definition",
    "href": "case-studies/01-avian-parasites/dummy.html#model-definition",
    "title": "2  Avian blood parasites",
    "section": "",
    "text": "Parasite co-occurrence only (just X₁, no other covariates)\nHost abundance only (just X, the ‘host abundance model’)\nCombined model (both X₁ and X, co-occurrence + host abundance)\n\n\n\n\n2.1.1 Model 1: Combined model (co-occurrence + host abundance)\n\nyhats_rf_combined &lt;- mrIMLpredicts(\n  X = X,\n  Y = Y,\n  X1 = X1,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.7,\n  k = 5,\n  racing = TRUE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n\n\n2.1.2 Model 2: Host abundance only\n\nyhats_rf_nox1 &lt;- mrIMLpredicts(\n  X = X,\n  Y = Y,\n  X1 = NULL,\n  Model = model_rf,\n  balance_data = 'down',\n  tune_grid_size = 5,\n  prop = 0.7,\n  k = 5,\n  racing = TRUE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n\n\n2.1.3 Model 3: Co-occurrence only\n\nyhats_rf_nox &lt;- mrIMLpredicts(\n  X = NULL,\n  Y = Y,\n  X1 = X1,\n  Model = model_rf,\n  balance_data = 'down',\n  tune_grid_size = 5,\n  prop = 0.7,\n  k = 5,\n  racing = TRUE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#model-performance",
    "href": "case-studies/01-avian-parasites/dummy.html#model-performance",
    "title": "2  Avian blood parasites",
    "section": "2.2 Model performance",
    "text": "2.2 Model performance\nThe proformance of each model for the diferen taxa can be explored using mrIMLperformance(). Below is an example for the combined model.\n\nModelPerf_combined &lt;- mrIMLperformance(yhats_rf_combined)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nModelPerf_combined$model_performance\n\n# A tibble: 4 × 8\n  response     model_name roc_AUC   mcc sensitivity   ppv specificity prevalence\n  &lt;chr&gt;        &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;\n1 Hkillangoi   rand_fore…   0.851 0.366       0.983 0.908       0.25      0.116 \n2 Hzosteropis  rand_fore…   0.901 0.649       0.93  0.894       0.694     0.265 \n3 Microfilaria rand_fore…   0.954 0           1     0.926       0         0.0980\n4 Plas         rand_fore…   0.907 0.369       0.936 0.857       0.370     0.196 \n\n\nWe compare the three model configerations against one another based on average AUC.\n\n# Evaluate model performance\nModelPerf_noX1 &lt;- mrIMLperformance(yhats_rf_nox1)\nModelPerf_noX &lt;- mrIMLperformance(yhats_rf_nox)\n\ntibble(\n  Model = c(\n    \"Combined model\",\n    \"Host abundance only\",\n    \"Co-occurrence only\"\n  ),\n  AUC = c(\n    ModelPerf_combined$model_performance$roc_AUC %&gt;%\n      mean(),\n    ModelPerf_noX1$model_performance$roc_AUC %&gt;%\n      mean(),\n    ModelPerf_noX$model_performance$roc_AUC %&gt;%\n      mean()\n  ) %&gt;%\n    round(., 3)\n)\n\n# A tibble: 3 × 2\n  Model                 AUC\n  &lt;chr&gt;               &lt;dbl&gt;\n1 Combined model      0.903\n2 Host abundance only 0.814\n3 Co-occurrence only  0.674\n\n\nThe combined model shows improved performance over the individual components, suggesting that both co-occurrence patterns and host abundance contribute to parasite distribution patterns, however this is a small dataset and so there is significant variation in the metric depending on the cross-validation and test-training split.",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#bootstrap-analysis-for-uncertainty-estimation",
    "href": "case-studies/01-avian-parasites/dummy.html#bootstrap-analysis-for-uncertainty-estimation",
    "title": "2  Avian blood parasites",
    "section": "2.3 Bootstrap Analysis for Uncertainty Estimation",
    "text": "2.3 Bootstrap Analysis for Uncertainty Estimation\nFrom here on, we focus on the combined model. However, we can use bootstraping to capture the uncertainty.\n\n# Run bootstrap analysis for uncertainty estimation\nbs_avian &lt;- yhats_rf_combined %&gt;%\n  mrBootstrap(num_bootstrap = 100)\n\n\n# Calculate variable importance with bootstrap confidence intervals\nbs_impVI &lt;- mrVip(\n  yhats_rf_combined,\n  mrBootstrap_obj = bs_avian,\n  threshold = 0.0,\n  global_top_var = 10,\n  local_top_var = 5,\n  model_perf = ModelPerf_combined\n)\n\n# Display variable importance plot\nbs_impVI[[3]]",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#partial-dependence-analysis",
    "href": "case-studies/01-avian-parasites/dummy.html#partial-dependence-analysis",
    "title": "2  Avian blood parasites",
    "section": "2.4 Partial Dependence Analysis",
    "text": "2.4 Partial Dependence Analysis\n\n# Create bootstrapped partial dependence plots for Plasmodium\npds &lt;- mrPdPlotBootstrap(\n  yhats_rf_combined,\n  mrBootstrap_obj = bs_avian,\n  vi_obj = bs_impVI,\n  target = 'Plas',\n  global_top_var = 5\n)\n\n# Display partial dependence plots\npds[[2]]",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#environmental-covariate-effects",
    "href": "case-studies/01-avian-parasites/dummy.html#environmental-covariate-effects",
    "title": "2  Avian blood parasites",
    "section": "2.5 Environmental Covariate Effects",
    "text": "2.5 Environmental Covariate Effects\n\n# Examine the relationship between host abundance and parasite occurrence\ncovar &lt;- mrCovar(\n  yhats_rf_combined,\n  var = 'scale.prop.zos',\n  sdthresh = 0.01\n)\n\n# Display the three components of covariate analysis\ncovar[[1]] / covar[[2]] / covar[[3]]",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#interaction-analysis",
    "href": "case-studies/01-avian-parasites/dummy.html#interaction-analysis",
    "title": "2  Avian blood parasites",
    "section": "2.6 Interaction Analysis",
    "text": "2.6 Interaction Analysis\n\n# Analyze feature interactions using H-statistics\nint_ &lt;- mrInteractions(\n  yhats_rf_combined,\n  num_bootstrap = 100,\n  feature = 'Plas',\n  top_int = 10\n)\n\n# Display interaction plots\nint_[[1]] / int_[[2]] / int_[[3]]",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#shap-analysis-for-individual-predictions",
    "href": "case-studies/01-avian-parasites/dummy.html#shap-analysis-for-individual-predictions",
    "title": "2  Avian blood parasites",
    "section": "2.7 SHAP Analysis for Individual Predictions",
    "text": "2.7 SHAP Analysis for Individual Predictions\n\n# Perform SHAP analysis for detailed feature attribution\nshap_results &lt;- mrShapely(\n  yhats_rf_combined,\n  taxa = \"Plas\",\n  plot_feature_effects = TRUE,\n  plot_dependencies = TRUE,\n  plot_2D_dependencies = TRUE\n)\n\nExact Kernel SHAP values\n\n\n\np &lt;- (shap_results$dependencies2D$Plas[[2]][[2]] +\n  scale_colour_viridis_c(limits = c(-0.4, 0.8), option = \"B\") +\n  theme_minimal() +\n  labs(title = \"b)\")) +\n  (shap_results$dependencies2D$Plas[[1]][[2]] +\n    scale_colour_viridis_c(limits = c(-0.4, 0.8), option = \"B\") +\n    theme_minimal() +\n    labs(title = \"c)\")) +\n  patchwork::plot_layout(ncol = 2, guides = \"collect\")\n\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\nScale for colour is already present.\nAdding another scale for colour, which will replace the existing scale.\n\np",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/01-avian-parasites/dummy.html#co-occurrence-network-construction",
    "href": "case-studies/01-avian-parasites/dummy.html#co-occurrence-network-construction",
    "title": "2  Avian blood parasites",
    "section": "2.8 Co-occurrence Network Construction",
    "text": "2.8 Co-occurrence Network Construction\n\n# Build co-occurrence network from bootstrap results\nassoc_net &lt;- mrCoOccurNet(bs_avian)\n\nplot_network(\n  assoc_net,\n  strength_threash = 0.05,\n  network_title = \"Parasite Co-occurrence Network\"\n)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Avian blood parasites</span>"
    ]
  },
  {
    "objectID": "case-studies/02-forest-communities/dummy.html",
    "href": "case-studies/02-forest-communities/dummy.html",
    "title": "3  Forest communities: beetles, birds and plants",
    "section": "",
    "text": "3.1 Data Preparation\nThis case study demonstrates MrIML 2.0 on a larger dataset with multiple taxonomic groups across a forest successional gradient. We analyze 144 plots established across forest age categories:\nAt each plot, we recorded ground-active beetles, plants, and birds, along with environmental covariates including coarse wood debris, leaf litter depth, and soil variables (pH, conductivity).\nraw_predictors &lt;- read_excel(\n  file.path(data_dir, \"Site_covariates_decision_making_4.xlsx\"),\n  sheet = 4\n) %&gt;%\n  column_to_rownames(var = \"plot_code\") %&gt;%\n  rename_all(~ gsub(\" \", \"_\", .)) %&gt;%\n  dplyr::select(-plot_code_T_D, -Transect)\n\ndatatable(raw_predictors)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Forest communities: beetles, birds and plants</span>"
    ]
  },
  {
    "objectID": "case-studies/02-forest-communities/dummy.html#data-preparation",
    "href": "case-studies/02-forest-communities/dummy.html#data-preparation",
    "title": "3  Forest communities: beetles, birds and plants",
    "section": "",
    "text": "BeetlesBirdsPlants\n\n\n\nraw_data_beetles &lt;- read_excel(\n  file.path(data_dir, \"all_taxa_all_sp_mat_sp.xlsx\"),\n  sheet = \"beetles_all\",\n) %&gt;%\n  dplyr::select(-Site, -Distance, -Transect, -Age) %&gt;%\n  rename_all(~ gsub(\" \", \"_\", .)) %&gt;%\n  column_to_rownames(var = \"Plot\") %&gt;%\n  mutate_all(~ ifelse(. &gt; 0, 1, .))\n\ndatatable(raw_data_beetles)\n\n\n\n\n\n\n\n\nraw_data_birds &lt;- read_excel(\n  file.path(data_dir, \"all_taxa_all_sp_mat_sp.xlsx\"),\n  sheet = \"birds_all\"\n) %&gt;%\n  dplyr::select(-Site, -Distance, -Transect, -Age) %&gt;%\n  rename_all(~ gsub(\" \", \"_\", .)) %&gt;%\n  column_to_rownames(var = \"Plot\") %&gt;%\n  mutate_all(~ ifelse(. &gt; 0, 1, .))\n\ndatatable(raw_data_birds)\n\n\n\n\n\n\n\n\nraw_data_plants &lt;- read_excel(\n  file.path(data_dir, \"all_taxa_all_sp_mat_sp.xlsx\"),\n  sheet = \"plants_all\"\n) %&gt;%\n  dplyr::select(-Site, -Distance, -Transect, -Age) %&gt;%\n  rename_all(~ gsub(\" \", \"_\", .)) %&gt;%\n  column_to_rownames(var = \"Plot\") %&gt;%\n  mutate_all(~ ifelse(. &gt; 0, 1, .))\n\ndatatable(raw_data_plants)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Forest communities: beetles, birds and plants</span>"
    ]
  },
  {
    "objectID": "case-studies/02-forest-communities/dummy.html#model",
    "href": "case-studies/02-forest-communities/dummy.html#model",
    "title": "3  Forest communities: beetles, birds and plants",
    "section": "3.2 Model",
    "text": "3.2 Model\nThis analysis uses a random forrest model.\n\nmodel_rf &lt;- rand_forest(\n  trees = 1000,\n  mode = \"classification\",\n  mtry = tune(),\n  min_n = tune()\n) %&gt;%\n  set_engine(\"randomForest\")",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Forest communities: beetles, birds and plants</span>"
    ]
  },
  {
    "objectID": "case-studies/02-forest-communities/dummy.html#beetle-community-analysis",
    "href": "case-studies/02-forest-communities/dummy.html#beetle-community-analysis",
    "title": "3  Forest communities: beetles, birds and plants",
    "section": "3.3 Beetle Community Analysis",
    "text": "3.3 Beetle Community Analysis\nPreparing the X and Y matrix for mrIML.\n\n# Filter rare and common species (20-70% prevalence)\nY_beetles &lt;- filterRareCommon(raw_data_beetles, lower = 0.2, higher = 0.7)\n\n# Prepare environmental predictors\nX_beetles &lt;- raw_predictors %&gt;%\n  dplyr::select(\n    -Beetles_S_Mat_Indval2,\n    -Beetle_S_Total,\n    -dist_regrowth,\n    -Age,\n    -Beetles_Mat_Ratio,\n    -Birds_S_Mat_EFL,\n    -Birds_S_Total,\n    -Birds_Mat_Ratio,\n    -slope_f_Jayne,\n    -aspect_f_Jayne\n  )\n\n# Convert categorical variables\nX_beetles$Site &lt;- as.factor(X_beetles$Site)\nX_beetles$geol_Jayne &lt;- as.factor(X_beetles$geol_Jayne)\n\n# Variable selection\nvar_sel_beetles &lt;- select_variables(Y = Y_beetles, X = X_beetles)\nX_beetles &lt;- var_sel_beetles[[2]]\n\n# Remove site for model comparison\nX_beetles$Site &lt;- NULL\n\n# Co-occurrence matrix\nX1_beetles &lt;- Y_beetles\n\n\n3.3.1 Beetle Model Configuration and Training\n\n# Model 1: Environment only\nyhats_beetles_env &lt;- mrIMLpredicts(\n  X = X_beetles,\n  Y = Y_beetles,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\nSetting dummy = TRUE because X contains factors.\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x2\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Model 2: Co-occurrence only\nyhats_beetles_cooccur &lt;- mrIMLpredicts(\n  Y = Y_beetles,\n  X1 = X1_beetles,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Model 3: Combined\nyhats_beetles_combined &lt;- mrIMLpredicts(\n  X = X_beetles,\n  Y = Y_beetles,\n  X1 = X1_beetles,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\nSetting dummy = TRUE because X contains factors.\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n\n\n3.3.2 Beetle Performance Assessment\n\n# Evaluate model performance\nModelPerf_beetles_env &lt;- mrIMLperformance(yhats_beetles_env)\nModelPerf_beetles_cooccur &lt;- mrIMLperformance(yhats_beetles_cooccur)\nModelPerf_beetles_combined &lt;- mrIMLperformance(yhats_beetles_combined)\n\n# Performance comparison\nperf_comparison_beetles &lt;- mrPerformancePlot(\n  ModelPerf1 = ModelPerf_beetles_combined,\n  ModelPerf2 = ModelPerf_beetles_env,\n  mode = \"classification\"\n)\n\nperf_comparison_beetles$performance_plot +\n  labs(title = \"Beetle Community Model Performance\")\n\n# Summary table\nbeetle_performance &lt;- data.frame(\n  Model = c(\"Environment only\", \"Co-occurrence only\", \"Combined\"),\n  MCC = c(\n    ModelPerf_beetles_env[[2]],\n    ModelPerf_beetles_cooccur[[2]],\n    ModelPerf_beetles_combined[[2]]\n  )\n)\nbeetle_performance\n\n\n\n3.3.3 Beetle Variable Importance and Associations\n\n# Bootstrap analysis\nbs_beetles &lt;- mrBootstrap(yhats_beetles_combined, num_bootstrap = 100)\n\n\n# Variable importance\nvi_beetles &lt;- mrVip(\n  yhats_beetles_combined,\n  mrBootstrap_obj = bs_beetles,\n  threshold = 0.5,\n  global_top_var = 10\n)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nvi_beetles[[3]] +\n  labs(title = \"Beetle Community Variable Importance\")\n\n\n\n\n\n\n\n\n\n# Co-occurrence network\nassoc_net_beetles &lt;- mrCoOccurNet(bs_beetles)\nplot_network(\n  assoc_net_beetles,\n  strength_threash = 0.1,\n  network_title = \"Beetle Co-occurrence Network\"\n)\n\nWarning in plot_network(assoc_net_beetles, strength_threash = 0.1,\nnetwork_title = \"Beetle Co-occurrence Network\"): No effects above the specified\nthreashold of 0.1\n\n\nNULL\n\n\n\n\n3.3.4 Beetle interactions\n\ninteractions_rf &lt;- yhats_beetles_combined %&gt;%\n  mrInteractions(num_bootstrap = 10)\n\ninteractions_rf[[1]]",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Forest communities: beetles, birds and plants</span>"
    ]
  },
  {
    "objectID": "case-studies/02-forest-communities/dummy.html#bird-community-analysis",
    "href": "case-studies/02-forest-communities/dummy.html#bird-community-analysis",
    "title": "3  Forest communities: beetles, birds and plants",
    "section": "3.4 Bird community analysis",
    "text": "3.4 Bird community analysis\n\n# Prepare bird data (similar structure to beetles)\nY_birds &lt;- filterRareCommon(raw_data_birds, lower = 0.2, higher = 0.7)\n\n# Use same environmental predictors but select relevant variables\n# Prepare environmental predictors\nX_birds &lt;- raw_predictors %&gt;%\n  dplyr::select(\n    -Beetles_S_Mat_Indval2,\n    -Beetle_S_Total,\n    -dist_regrowth,\n    -Age,\n    -Beetles_Mat_Ratio,\n    -Birds_S_Mat_EFL,\n    -Birds_S_Total,\n    -Birds_Mat_Ratio,\n    -slope_f_Jayne,\n    -aspect_f_Jayne\n  )\n\n# Convert categorical variables\nX_birds$Site &lt;- as.factor(X_birds$Site)\nX_birds$geol_Jayne &lt;- as.factor(X_birds$geol_Jayne)\n\n# Remove site for model comparison\nX_birds$Site &lt;- NULL\nvar_sel_birds &lt;- select_variables(Y = Y_birds, X = X_birds)\nX_birds &lt;- var_sel_birds[[2]]\nX1_birds &lt;- Y_birds\n\n# Train models\nyhats_birds_env &lt;- mrIMLpredicts(\n  X = X_birds,\n  Y = Y_birds,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\nSetting dummy = TRUE because X contains factors.\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\nyhats_birds_cooccur &lt;- mrIMLpredicts(\n  Y = Y_birds,\n  X1 = X1_birds,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\nyhats_birds_combined &lt;- mrIMLpredicts(\n  X = X_birds,\n  Y = Y_birds,\n  X1 = X1_birds,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\nSetting dummy = TRUE because X contains factors.\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x2\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Performance assessment\nModelPerf_birds_env &lt;- mrIMLperformance(yhats_birds_env)\nModelPerf_birds_cooccur &lt;- mrIMLperformance(yhats_birds_cooccur)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nModelPerf_birds_combined &lt;- mrIMLperformance(yhats_birds_combined)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\n# Performance comparison\nperf_comparison_birds &lt;- mrPerformancePlot(\n  ModelPerf1 = ModelPerf_birds_combined,\n  ModelPerf2 = ModelPerf_birds_env,\n  mode = \"classification\"\n)\n\n\n# Plot performance\nperf_comparison_birds$performance_plot +\n  labs(title = \"Bird Community Model Performance\")\n\nWarning: The following aesthetics were dropped during statistical transformation: label.\nℹ This can happen when ggplot fails to infer the correct grouping structure in\n  the data.\nℹ Did you forget to specify a `group` aesthetic or to convert a numerical\n  variable into a factor?\n\n\n\n\n\n\n\n\n\n\n# Performance summary table\nbird_performance &lt;- data.frame(\n  Model = c(\"Environment only\", \"Co-occurrence only\", \"Combined\"),\n  MCC = c(\n    ModelPerf_birds_env[[2]],\n    ModelPerf_birds_cooccur[[2]],\n    ModelPerf_birds_combined[[2]]\n  )\n)\nbird_performance\n\n               Model        MCC\n1   Environment only 0.20896812\n2 Co-occurrence only 0.02983434\n3           Combined 0.17430102\n\n\n\n# Bootstrap analysis\nbs_birds &lt;- mrBootstrap(yhats_birds_combined, num_bootstrap = 100)\n\n# Variable importance\nvi_birds &lt;- mrVip(\n  yhats_birds_combined,\n  mrBootstrap_obj = bs_birds,\n  threshold = 0.5,\n  global_top_var = 10\n)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\n\n\n# Variable importance plot\nvi_birds[[3]] +\n  labs(title = \"Bird Community Variable Importance\")\n\n\n\n\n\n\n\n\n\n# Co-occurrence network\nassoc_net_birds &lt;- mrCoOccurNet(bs_birds)\nplot_network(\n  assoc_net_birds,\n  strength_threash = 0.1,\n  network_title = \"Bird Co-occurrence Network\"\n)\n\nWarning in plot_network(assoc_net_birds, strength_threash = 0.1, network_title\n= \"Bird Co-occurrence Network\"): No effects above the specified threashold of\n0.1\n\n\nNULL",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Forest communities: beetles, birds and plants</span>"
    ]
  },
  {
    "objectID": "case-studies/02-forest-communities/dummy.html#plant-community-analysis",
    "href": "case-studies/02-forest-communities/dummy.html#plant-community-analysis",
    "title": "3  Forest communities: beetles, birds and plants",
    "section": "3.5 Plant community analysis",
    "text": "3.5 Plant community analysis\n\n# Prepare Plant data (similar structure to beetles)\nY_plants &lt;- filterRareCommon(raw_data_plants, lower = 0.2, higher = 0.7)\n\n# Use same environmental predictors but select relevant variables\n# Prepare environmental predictors\nX_plants &lt;- raw_predictors %&gt;%\n  dplyr::select(\n    -Beetles_S_Mat_Indval2,\n    -Beetle_S_Total,\n    -dist_regrowth,\n    -Age,\n    -Beetles_Mat_Ratio,\n    -Birds_S_Mat_EFL,\n    -Birds_S_Total,\n    -Birds_Mat_Ratio,\n    -slope_f_Jayne,\n    -aspect_f_Jayne,\n    -contains(\"Bryo\"),\n    -contains(\"Plant\"),\n    -contains(\"Moss\"),\n    -Vegetation_cover\n  ) %&gt;%\n  rename_with(~ gsub(\"Jayne\", \"\", .), contains(\"Jayne\"))\n\n# Convert categorical variables\nX_plants$Site &lt;- as.factor(X_plants$Site)\nX_plants$geol_ &lt;- as.factor(X_plants$geol_)\n\n# Remove site for model comparison\nX_plants$Site &lt;- NULL\nvar_sel_plants &lt;- select_variables(Y = Y_plants, X = X_plants)\nX_plants &lt;- var_sel_plants[[2]]\nX1_plants &lt;- Y_plants\n\n# Train models\nyhats_plants_env &lt;- mrIMLpredicts(\n  X = X_plants,\n  Y = Y_plants,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\nSetting dummy = TRUE because X contains factors.\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x10\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\nyhats_plants_cooccur &lt;- mrIMLpredicts(\n  Y = Y_plants,\n  X1 = X1_plants,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\nyhats_plants_combined &lt;- mrIMLpredicts(\n  X = X_plants,\n  Y = Y_plants,\n  X1 = X1_plants,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = TRUE\n)\n\nSetting dummy = TRUE because X contains factors.\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x1\n\n\nThere were issues with some computations   A: x10\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Performance assessment\nModelPerf_plants_env &lt;- mrIMLperformance(yhats_plants_env)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nModelPerf_plants_cooccur &lt;- mrIMLperformance(yhats_plants_cooccur)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nModelPerf_plants_combined &lt;- mrIMLperformance(yhats_plants_combined)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\n# Performance comparison\nperf_comparison_plants &lt;- mrPerformancePlot(\n  ModelPerf1 = ModelPerf_plants_combined,\n  ModelPerf2 = ModelPerf_plants_env,\n  mode = \"classification\"\n)\n\n\n# Plot performance\nperf_comparison_plants$performance_plot +\n  labs(title = \"Bird Community Model Performance\")\n\nWarning: The following aesthetics were dropped during statistical transformation: label.\nℹ This can happen when ggplot fails to infer the correct grouping structure in\n  the data.\nℹ Did you forget to specify a `group` aesthetic or to convert a numerical\n  variable into a factor?\n\n\n\n\n\n\n\n\n\n\n# Performance summary table\nplant_performance &lt;- data.frame(\n  Model = c(\"Environment only\", \"Co-occurrence only\", \"Combined\"),\n  MCC = c(\n    ModelPerf_plants_env[[2]],\n    ModelPerf_plants_cooccur[[2]],\n    ModelPerf_plants_combined[[2]]\n  )\n)\nplant_performance\n\n               Model       MCC\n1   Environment only 0.4644385\n2 Co-occurrence only 0.3957885\n3           Combined 0.4860622\n\n\n\n# Bootstrap analysis\nbs_plants &lt;- mrBootstrap(\n  yhats_plants_combined,\n  num_bootstrap = 100\n)\n\n# Variable importance\nvi_plants &lt;- mrVip(\n  yhats_plants_combined,\n  mrBootstrap_obj = bs_plants,\n  threshold = 0.5,\n  global_top_var = 10\n)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\n\n\n# Variable importance plot\nvi_plants[[3]] +\n  labs(title = \"Bird Community Variable Importance\")\n\n\n\n\n\n\n\n\n\n# Co-occurrence network\nassoc_net_plants &lt;- mrCoOccurNet(bs_plants)\nplot_network(\n  assoc_net_plants,\n  strength_threash = 0.1,\n  network_title = \"Plant Co-occurrence Network\",\n  nmds_layout = TRUE\n)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Forest communities: beetles, birds and plants</span>"
    ]
  },
  {
    "objectID": "case-studies/03-ostrich-microbiome/dummy.html",
    "href": "case-studies/03-ostrich-microbiome/dummy.html",
    "title": "4  Ostrich gut microbiome",
    "section": "",
    "text": "4.1 Define tidymodel\nmodel_rf &lt;- rand_forest(\n  trees = 1000,\n  mode = \"classification\",\n  mtry = tune(),\n  min_n = tune()\n) %&gt;%\n  set_engine(\"randomForest\")",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Ostrich gut microbiome</span>"
    ]
  },
  {
    "objectID": "case-studies/03-ostrich-microbiome/dummy.html#caecum",
    "href": "case-studies/03-ostrich-microbiome/dummy.html#caecum",
    "title": "4  Ostrich gut microbiome",
    "section": "4.2 Caecum",
    "text": "4.2 Caecum\n\n4.2.1 Model fitting\n\nX1_caecum &lt;- Y_caecumF\nX_caecum &lt;- X_caecum\nY_caecum &lt;- Y_caecumF\n\nyhats_rf_caecum_combined &lt;- mrIMLpredicts(\n  X = X_caecum,\n  Y = Y_caecum,\n  X1 = X1_caecum,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.7,\n  k = 5,\n  racing = F\n)\nyhats_rf_caecum_noX1 &lt;- mrIMLpredicts(\n  X = X_caecum,\n  Y = Y_caecum,\n  #X1=X1,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = F\n)\nyhats_rf_caecum_noX &lt;- mrIMLpredicts(\n  X = NULL,\n  Y = Y_caecum,\n  X1 = X1_caecum,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = F\n)\n\n\n\n4.2.2 Performance\n\nmodel_perf_caecum_combined &lt;- mrIMLperformance(yhats_rf_caecum_combined)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nmodel_perf_caecum_noX1 &lt;- mrIMLperformance(yhats_rf_caecum_noX1)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nmodel_perf_caecum_noX &lt;- mrIMLperformance(yhats_rf_caecum_noX)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\ndata.frame(\n  Model = c(\"Host characteristics\", \"Co-occurrence only\", \"Combined\"),\n  MCC = c(\n    model_perf_caecum_combined[[2]],\n    model_perf_caecum_noX1[[2]],\n    model_perf_caecum_noX[[2]]\n  )\n)\n\n                 Model       MCC\n1 Host characteristics 0.5182090\n2   Co-occurrence only 0.4013851\n3             Combined 0.4884001\n\n\n\n# Need to increase memory allowance for workers.\noptions(future.globals.maxSize = 10 * 1024^3)\nbootstrap_caecum_combined &lt;- mrBootstrap(\n  yhats_rf_caecum_combined,\n  num_bootstrap = 10\n)\n\nvip_caecum_combined &lt;- mrVip(\n  yhats_rf_caecum_combined,\n  bootstrap_caecum_combined\n)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nvip_caecum_combined[[3]]\n\n\n\n\n\n\n\n\n\nprofilePlot_pd_caecum &lt;- mrCovar(\n  yhats_rf_caecum_combined,\n  var = \"Age\",\n  sdthresh = 0.1\n)\nprofilePlot_pd_caecum[[1]]\n\n\n\n\n\n\n\n\n\n\n4.2.3 Co-occurance network\n\nassoc_net_caecum &lt;- mrCoOccurNet(bootstrap_caecum_combined)\nplot_network(\n  assoc_net_caecum,\n  strength_threash = 0.1,\n  network_title = \"Caecum Co-occurrence Network\",\n  nmds_layout = TRUE,\n  degree = TRUE,\n  group_colours = TRUE\n)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Ostrich gut microbiome</span>"
    ]
  },
  {
    "objectID": "case-studies/03-ostrich-microbiome/dummy.html#colon",
    "href": "case-studies/03-ostrich-microbiome/dummy.html#colon",
    "title": "4  Ostrich gut microbiome",
    "section": "4.3 Colon",
    "text": "4.3 Colon\n\nX1_colon &lt;- Y_colonF\nX_colon &lt;- X_colon\nY_colon &lt;- Y_colonF\n\nyhats_rf_colon_combined &lt;- mrIMLpredicts(\n  X = X_colon,\n  Y = Y_colon,\n  X1 = X1_colon,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.7,\n  k = 5,\n  racing = F\n)\nyhats_rf_colon_noX1 &lt;- mrIMLpredicts(\n  X = X_colon,\n  Y = Y_colon,\n  #X1=X1,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = F\n)\nyhats_rf_colon_noX &lt;- mrIMLpredicts(\n  X = NULL,\n  Y = Y_colon,\n  X1 = X1_colon,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = F\n)\n\n\nmodel_perf_colon_combined &lt;- mrIMLperformance(yhats_rf_colon_combined)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nmodel_perf_colon_noX1 &lt;- mrIMLperformance(yhats_rf_colon_noX1)\nmodel_perf_colon_noX &lt;- mrIMLperformance(yhats_rf_colon_noX)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\ndata.frame(\n  Model = c(\"Host characteristics\", \"Co-occurrence only\", \"Combined\"),\n  MCC = c(\n    model_perf_colon_combined[[2]],\n    model_perf_colon_noX1[[2]],\n    model_perf_colon_noX[[2]]\n  )\n)\n\n                 Model       MCC\n1 Host characteristics 0.5372354\n2   Co-occurrence only 0.4222740\n3             Combined 0.5130025\n\n\n\n# Need to increase memory allowance for workers.\noptions(future.globals.maxSize = 10 * 1024^3)\nbootstrap_colon_combined &lt;- mrBootstrap(\n  yhats_rf_colon_combined,\n  num_bootstrap = 10\n)\n\nvip_colon_combined &lt;- mrVip(\n  yhats_rf_colon_combined,\n  bootstrap_colon_combined\n)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nvip_colon_combined[[3]]\n\n\n\n\n\n\n\n\n\nprofilePlot_pd_colon &lt;- mrCovar(\n  yhats_rf_colon_combined,\n  var = \"Age\",\n  sdthresh = 0.1\n)\nprofilePlot_pd_colon[[1]]\n\n\n\n\n\n\n\n\n\nassoc_net_colon &lt;- mrCoOccurNet(bootstrap_colon_combined)\nplot_network(\n  assoc_net_colon,\n  strength_threash = 0.1,\n  network_title = \"Caecum Co-occurrence Network\",\n  nmds_layout = TRUE,\n  degree = TRUE,\n  group_colours = TRUE\n)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Ostrich gut microbiome</span>"
    ]
  },
  {
    "objectID": "case-studies/03-ostrich-microbiome/dummy.html#ileum",
    "href": "case-studies/03-ostrich-microbiome/dummy.html#ileum",
    "title": "4  Ostrich gut microbiome",
    "section": "4.4 Ileum",
    "text": "4.4 Ileum\n\nX1_ileum &lt;- Y_ileumF\nX_ileum &lt;- X_ileum\nY_ileum &lt;- Y_ileumF\n\nyhats_rf_ileum_combined &lt;- mrIMLpredicts(\n  X = X_ileum,\n  Y = Y_ileum,\n  X1 = X1_ileum,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.7,\n  k = 5,\n  racing = F\n)\nyhats_rf_ileum_noX1 &lt;- mrIMLpredicts(\n  X = X_ileum,\n  Y = Y_ileum,\n  #X1=X1,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = F\n)\nyhats_rf_ileum_noX &lt;- mrIMLpredicts(\n  X = NULL,\n  Y = Y_ileum,\n  X1 = X1_ileum,\n  Model = model_rf,\n  balance_data = 'no',\n  tune_grid_size = 5,\n  prop = 0.6,\n  k = 5,\n  racing = F\n)\n\n\nmodel_perf_ileum_combined &lt;- mrIMLperformance(yhats_rf_ileum_combined)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nmodel_perf_ileum_noX1 &lt;- mrIMLperformance(yhats_rf_ileum_noX1)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nmodel_perf_ileum_noX &lt;- mrIMLperformance(yhats_rf_ileum_noX)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\ndata.frame(\n  Model = c(\"Host characteristics\", \"Co-occurrence only\", \"Combined\"),\n  MCC = c(\n    model_perf_ileum_combined[[2]],\n    model_perf_ileum_noX1[[2]],\n    model_perf_ileum_noX[[2]]\n  )\n)\n\n                 Model       MCC\n1 Host characteristics 0.2887763\n2   Co-occurrence only 0.1863150\n3             Combined 0.2957115\n\n\n\n# Need to increase memory allowance for workers.\noptions(future.globals.maxSize = 10 * 1024^3)\nbootstrap_ileum_combined &lt;- mrBootstrap(\n  yhats_rf_ileum_combined,\n  num_bootstrap = 10\n)\n\nvip_ileum_combined &lt;- mrVip(\n  yhats_rf_ileum_combined,\n  bootstrap_ileum_combined\n)\n\nWarning: NAs produced when calculating MCC. This is common when there is a\nclass imbalance. Substituting NA values with zero.\n\nvip_ileum_combined\n\n\n\n\n\n\n\n\n\nprofilePlot_pd_ileum &lt;- mrCovar(\n  yhats_rf_ileum_combined,\n  var = \"Age\",\n  sdthresh = 0.1\n)\nprofilePlot_pd_ileum[[1]]\n\n\n\n\n\n\n\n\n\nassoc_net_ileum &lt;- mrCoOccurNet(bootstrap_ileum_combined)\nplot_network(\n  assoc_net_ileum,\n  strength_threash = 0.1,\n  network_title = \"Caecum Co-occurrence Network\",\n  nmds_layout = TRUE,\n  degree = TRUE,\n  group_colours = TRUE\n)",
    "crumbs": [
      "Case studies",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Ostrich gut microbiome</span>"
    ]
  },
  {
    "objectID": "sim-study/dummy.html",
    "href": "sim-study/dummy.html",
    "title": "5  Co-occurance simulations",
    "section": "",
    "text": "5.1 Mutualistic\nGenerate a co-ocurance matrix, M.\nplot population dynamics\nGenerate dataset on species abundance using the GLV model and convert to presence-absence data.\nPrepare data and fit mrIML model.\nPerform bootstrapping.\nExtract co-occurance network.\nPlot the network alongside the truth.\nCompare the learned networks with the truth.\nsimulated_mutual_network &lt;- generateM_specific_type(\n  nn = network_size,\n  k_ave = k_average,\n  type.network = \"random\",\n  type.interact = \"mutual\",\n  interact.str.max = 0.3,\n  mix.compt.ratio = 0.5\n)\ntrue_mutual_network &lt;- simulated_mutual_network[[1]]\nM_mutual &lt;- simulated_mutual_network[[2]]\ndata_mutual &lt;- generateDataSet(\n  900,\n  M_mutual,\n  count = network_size * 10000,\n  mode = 4\n) %&gt;%\n  t() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(\n    across(everything(), ~ ifelse(. &lt; 1, yes = 0, no = 1))\n  )\n# Prepare data\nY_mutual &lt;- filterRareCommon(data_mutual, lower = 0.01, higher = 0.99)\nX1_mutual &lt;- Y_mutual\n# Fit mrIML obj\nyhats_rf_sim_mutual &lt;- mrIMLpredicts(\n  Y = Y_mutual,\n  X = NULL,\n  X1 = X1_mutual,\n  Model = model_rf,\n  prop = 0.7,\n  k = 5,\n  racing = FALSE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No event observations were detected in `truth` with event level '0'.\n\n\nThere were issues with some computations   A: x10\nThere were issues with some computations   A: x10\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Bootstrapping\nbs_sim_mutual &lt;- mrBootstrap(yhats_rf_sim_mutual)\n# Extract network\nassoc_net_mutual &lt;- mrCoOccurNet(bs_sim_mutual)\nmrIML_mat_mutual &lt;- assoc_net_mutual %&gt;%\n  filter(mean_strength &gt; 0.1) %&gt;%\n  mutate(\n    mean_strength_dir = ifelse(\n      direction == \"negative\",\n      yes = -mean_strength,\n      no = mean_strength\n    ),\n    across(contains(\"taxa\"), ~ sub(\"^sp\", \"\", .))\n  ) %&gt;%\n  graph_from_data_frame(\n    directed = FALSE,\n    vertices = sub(\"^sp\", \"\", names(Y_mutual))\n  ) %&gt;%\n  get.adjacency(attr = \"mean_strength_dir\", sparse = FALSE)\n\n#plots\ng_mrIML_mutual &lt;- graph_from_adjacency_matrix(\n  mrIML_mat_mutual,\n  mode = 'undirected',\n  weighted = T,\n  diag = F\n)\n\nedge_colors_mrIML_mutual &lt;- ifelse(\n  E(g_mrIML_mutual)$weight &lt; 0,\n  yes = \"red\",\n  no = \"blue\"\n)\nedge_widths_mrIML_mutual &lt;- abs(E(g_mrIML_mutual)$weight) * 10 # Adjust the scaling factor as needed\nmatching_indices_mutual &lt;- as.numeric(rownames(mrIML_mat_mutual))\n\ntrue_mat_mutual &lt;- M_mutual[matching_indices_mutual, matching_indices_mutual]\nrownames(true_mat_mutual) &lt;- rownames(mrIML_mat_mutual)\ncolnames(true_mat_mutual) &lt;- rownames(mrIML_mat_mutual)\ng_true_mutual &lt;- graph_from_adjacency_matrix(\n  true_mat_mutual,\n  mode = 'undirected',\n  weighted = T,\n  diag = F\n)\nedge_colors_true_mutual &lt;- ifelse(\n  E(g_true_mutual)$weight &lt; 0,\n  yes = \"red\",\n  no = \"blue\"\n)\nedge_widths_true_mutual &lt;- abs(E(g_true_mutual)$weight) * 5 # Adjust the scaling factor as needed\n\nlayout1_mutual &lt;- layout_nicely(g_true_mutual)\n\npar_old &lt;- par(mfrow = c(1, 2))\n\nplot(\n  g_mrIML_mutual,\n  layout = layout1_mutual,\n  edge.color = edge_colors_mrIML_mutual,\n  edge.width = edge_widths_mrIML_mutual,\n  isolates = TRUE,\n  main = \"mrIML co-occurence\"\n)\n\nplot(\n  g_true_mutual,\n  layout = layout1_mutual,\n  edge.color = edge_colors_true_mutual,\n  isolates = TRUE,\n  edge.width = edge_widths_true_mutual,\n  main = \"simulated co-occurence\"\n)\n\n\n\n\n\n\n\npar(par_old)\ndist_mat_true_mutual &lt;- 1 - true_mat_mutual\ndist_mat_mrIML_mutual &lt;- 1 - mrIML_mat_mutual\nmantel_result &lt;- vegan::mantel(\n  as.dist(dist_mat_true_mutual),\n  as.dist(dist_mat_mrIML_mutual),\n  method = \"pearson\"\n)\nmantel_result\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = as.dist(dist_mat_true_mutual), ydis = as.dist(dist_mat_mrIML_mutual),      method = \"pearson\") \n\nMantel statistic r: 0.3216 \n      Significance: 0.113 \n\nUpper quantiles of permutations (null model):\n  90%   95% 97.5%   99% \n0.322 0.442 0.494 0.637 \nPermutation: free\nNumber of permutations: 999",
    "crumbs": [
      "Simulation study",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Co-occurance simulations</span>"
    ]
  },
  {
    "objectID": "sim-study/dummy.html#competitive",
    "href": "sim-study/dummy.html#competitive",
    "title": "5  Co-occurance simulations",
    "section": "5.2 Competitive",
    "text": "5.2 Competitive\n\nsimulated_compt_network &lt;- generateM_specific_type(\n  nn = network_size,\n  k_ave = k_average,\n  type.network = \"random\",\n  type.interact = \"compt\",\n  interact.str.max = 0.5,\n  mix.compt.ratio = 0.5\n)\ntrue_compt_network &lt;- simulated_compt_network[[1]]\nM_compt &lt;- simulated_compt_network[[2]]\ndiag(M_compt) &lt;- -0.5 # Reduce the level of self regulation\n\n\ndata_compt &lt;- generateDataSet(\n  900,\n  M_compt,\n  count = network_size * 10000,\n  mode = 4\n) %&gt;%\n  t() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(\n    across(everything(), ~ ifelse(. &lt; 1, yes = 0, no = 1))\n  )\n\n\n# Prepare data\nY_compt &lt;- filterRareCommon(data_compt, lower = 0.01, higher = 0.99)\nX1_compt &lt;- Y_compt\n# Fit mrIML obj\nyhats_rf_sim_compt &lt;- mrIMLpredicts(\n  Y = Y_compt,\n  X = NULL,\n  X1 = X1_compt,\n  Model = model_rf,\n  prop = 0.7,\n  k = 5,\n  racing = FALSE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x1\nThere were issues with some computations   A: x1\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Bootstrapping\nbs_sim_compt &lt;- mrBootstrap(yhats_rf_sim_compt)\n# Extract network\nassoc_net_compt &lt;- mrCoOccurNet(bs_sim_compt)\n\n\nmrIML_mat_compt &lt;- assoc_net_compt %&gt;%\n  filter(mean_strength &gt; 0.1) %&gt;%\n  mutate(\n    mean_strength_dir = ifelse(\n      direction == \"negative\",\n      yes = -mean_strength,\n      no = mean_strength\n    ),\n    across(contains(\"taxa\"), ~ sub(\"^sp\", \"\", .))\n  ) %&gt;%\n  graph_from_data_frame(\n    directed = FALSE,\n    vertices = sub(\"^sp\", \"\", names(Y_compt))\n  ) %&gt;%\n  get.adjacency(attr = \"mean_strength_dir\", sparse = FALSE)\n\n#plots\ng_mrIML_compt &lt;- graph_from_adjacency_matrix(\n  mrIML_mat_compt,\n  mode = 'undirected',\n  weighted = T,\n  diag = F\n)\n\nedge_colors_mrIML_compt &lt;- ifelse(\n  E(g_mrIML_compt)$weight &lt; 0,\n  yes = \"red\",\n  no = \"blue\"\n)\nedge_widths_mrIML_compt &lt;- abs(E(g_mrIML_compt)$weight) * 10 # Adjust the scaling factor as needed\nmatching_indices_compt &lt;- as.numeric(rownames(mrIML_mat_compt))\n\ntrue_mat_compt &lt;- M_compt[matching_indices_compt, matching_indices_compt]\nrownames(true_mat_compt) &lt;- rownames(mrIML_mat_compt)\ncolnames(true_mat_compt) &lt;- rownames(mrIML_mat_compt)\ng_true_compt &lt;- graph_from_adjacency_matrix(\n  true_mat_compt,\n  mode = 'undirected',\n  weighted = T,\n  diag = F\n)\nedge_colors_true_compt &lt;- ifelse(\n  E(g_true_compt)$weight &lt; 0,\n  yes = \"red\",\n  no = \"blue\"\n)\nedge_widths_true_compt &lt;- abs(E(g_true_compt)$weight) * 5 # Adjust the scaling factor as needed\n\nlayout1_compt &lt;- layout_nicely(g_true_compt)\n\nWarning: Non-positive edge weight found, ignoring all weights during graph\nlayout.\n\npar_old &lt;- par(mfrow = c(1, 2))\n\nplot(\n  g_mrIML_compt,\n  layout = layout1_compt,\n  edge.color = edge_colors_mrIML_compt,\n  edge.width = edge_widths_mrIML_compt,\n  isolates = TRUE,\n  main = \"mrIML co-occurence\"\n)\n\nplot(\n  g_true_compt,\n  layout = layout1_compt,\n  edge.color = edge_colors_true_compt,\n  isolates = TRUE,\n  edge.width = edge_widths_true_compt,\n  main = \"simulated co-occurence\"\n)\n\n\n\n\n\n\n\npar(par_old)\n\n\ndist_mat_true_compt &lt;- 1 - true_mat_compt\ndist_mat_mrIML_compt &lt;- 1 - mrIML_mat_compt\nmantel_result &lt;- vegan::mantel(\n  as.dist(dist_mat_true_compt),\n  as.dist(dist_mat_mrIML_compt),\n  method = \"pearson\"\n)\nmantel_result\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = as.dist(dist_mat_true_compt), ydis = as.dist(dist_mat_mrIML_compt),      method = \"pearson\") \n\nMantel statistic r: 0.5831 \n      Significance: 0.001 \n\nUpper quantiles of permutations (null model):\n   90%    95%  97.5%    99% \n0.0958 0.1312 0.1536 0.1772 \nPermutation: free\nNumber of permutations: 999",
    "crumbs": [
      "Simulation study",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Co-occurance simulations</span>"
    ]
  },
  {
    "objectID": "sim-study/dummy.html#mixed",
    "href": "sim-study/dummy.html#mixed",
    "title": "5  Co-occurance simulations",
    "section": "5.3 Mixed",
    "text": "5.3 Mixed\n\nsimulated_mix_network &lt;- generateM_specific_type(\n  nn = network_size,\n  k_ave = k_average,\n  type.network = \"random\",\n  type.interact = \"mix\",\n  interact.str.max = 0.4,\n  mix.compt.ratio = 0.5\n)\ntrue_mix_network &lt;- simulated_mix_network[[1]]\nM_mix &lt;- simulated_mix_network[[2]]\n\n\ndata_mix &lt;- generateDataSet(\n  900,\n  M_mix,\n  count = network_size * 10000,\n  mode = 4\n) %&gt;%\n  t() %&gt;%\n  as.data.frame() %&gt;%\n  mutate(\n    across(everything(), ~ ifelse(. &lt; 1, yes = 0, no = 1))\n  )\n\n\n# Prepare data\nY_mix &lt;- filterRareCommon(data_mix, lower = 0.01, higher = 0.99)\nX1_mix &lt;- Y_mix\n# Fit mrIML obj\nyhats_rf_sim_mix &lt;- mrIMLpredicts(\n  Y = Y_mix,\n  X = NULL,\n  X1 = X1_mix,\n  Model = model_rf,\n  prop = 0.7,\n  k = 5,\n  racing = FALSE\n)\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x10\nThere were issues with some computations   A: x10\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n\n→ A | warning: No control observations were detected in `truth` with control level '1'.\n\n\nThere were issues with some computations   A: x10\n\n\nThere were issues with some computations   A: x20\nThere were issues with some computations   A: x20\n\n\n\n\n\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\ni Creating pre-processing data to finalize 1 unknown parameter: \"mtry\"\n\n# Bootstrapping\nbs_sim_mix &lt;- mrBootstrap(yhats_rf_sim_mix)\n# Extract network\nassoc_net_mix &lt;- mrCoOccurNet(bs_sim_mix)\n\n\nmrIML_mat_mix &lt;- assoc_net_mix %&gt;%\n  filter(mean_strength &gt; 0.1) %&gt;%\n  mutate(\n    mean_strength_dir = ifelse(\n      direction == \"negative\",\n      yes = -mean_strength,\n      no = mean_strength\n    ),\n    across(contains(\"taxa\"), ~ sub(\"^sp\", \"\", .))\n  ) %&gt;%\n  graph_from_data_frame(\n    directed = FALSE,\n    vertices = sub(\"^sp\", \"\", names(Y_mix))\n  ) %&gt;%\n  get.adjacency(attr = \"mean_strength_dir\", sparse = FALSE)\n\n#plots\ng_mrIML_mix &lt;- graph_from_adjacency_matrix(\n  mrIML_mat_mix,\n  mode = 'undirected',\n  weighted = T,\n  diag = F\n)\n\nedge_colors_mrIML_mix &lt;- ifelse(\n  E(g_mrIML_mix)$weight &lt; 0,\n  yes = \"red\",\n  no = \"blue\"\n)\nedge_widths_mrIML_mix &lt;- abs(E(g_mrIML_mix)$weight) * 10 # Adjust the scaling factor as needed\nmatching_indices_mix &lt;- as.numeric(rownames(mrIML_mat_mix))\n\ntrue_mat_mix &lt;- M_mix[matching_indices_mix, matching_indices_mix]\nrownames(true_mat_mix) &lt;- rownames(mrIML_mat_mix)\ncolnames(true_mat_mix) &lt;- rownames(mrIML_mat_mix)\ng_true_mix &lt;- graph_from_adjacency_matrix(\n  true_mat_mix,\n  mode = 'undirected',\n  weighted = T,\n  diag = F\n)\nedge_colors_true_mix &lt;- ifelse(\n  E(g_true_mix)$weight &lt; 0,\n  yes = \"red\",\n  no = \"blue\"\n)\nedge_widths_true_mix &lt;- abs(E(g_true_mix)$weight) * 5 # Adjust the scaling factor as needed\n\nlayout1_mix &lt;- layout_nicely(g_true_mix)\n\nWarning: Non-positive edge weight found, ignoring all weights during graph\nlayout.\n\npar_old &lt;- par(mfrow = c(1, 2))\n\nplot(\n  g_mrIML_mix,\n  layout = layout1_mix,\n  edge.color = edge_colors_mrIML_mix,\n  edge.width = edge_widths_mrIML_mix,\n  isolates = TRUE,\n  main = \"mrIML co-occurence\"\n)\n\nplot(\n  g_true_mix,\n  layout = layout1_mix,\n  edge.color = edge_colors_true_mix,\n  isolates = TRUE,\n  edge.width = edge_widths_true_mix,\n  main = \"simulated co-occurence\"\n)\n\n\n\n\n\n\n\npar(par_old)\n\n\ndist_mat_true_mix &lt;- 1 - true_mat_mix\ndist_mat_mrIML_mix &lt;- 1 - mrIML_mat_mix\nmantel_result &lt;- vegan::mantel(\n  as.dist(dist_mat_true_mix),\n  as.dist(dist_mat_mrIML_mix),\n  method = \"pearson\"\n)\nmantel_result\n\n\nMantel statistic based on Pearson's product-moment correlation \n\nCall:\nvegan::mantel(xdis = as.dist(dist_mat_true_mix), ydis = as.dist(dist_mat_mrIML_mix),      method = \"pearson\") \n\nMantel statistic r: 0.676 \n      Significance: 0.001 \n\nUpper quantiles of permutations (null model):\n  90%   95% 97.5%   99% \n0.108 0.145 0.165 0.208 \nPermutation: free\nNumber of permutations: 999",
    "crumbs": [
      "Simulation study",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Co-occurance simulations</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Fountain-Jones, Nicholas M, Raima Carol Appaw, Moh A Alkhamis, Susan C\nBaker, Francisca Powell-Romero, Nicholas J Clark, Michael Mayer, Gustavo\nMachado, and Elin Videvall. 2024. “Advancing Ecological Community\nAnalysis with MrIML 2.0: Unravelling Taxa Associations Through\nInterpretable Machine Learning.” https://doi.org/DOI:\n10.22541/au.172676147.77148600/v1.",
    "crumbs": [
      "References"
    ]
  }
]